!function(a){function b(a,b){var c=b?"hover":"nohover",d=b?"nohover":"hover";a.hasClass(c)||a.addClass(c).removeClass(d)}function c(a,b,d){if(1===a.nodeType&&b.call(a,a,d)!==!1)for(var e=0,f=a.childNodes.length;f>e;e++)c(a.childNodes[e],b,d)}function d(b,d){var e=[];return b.each(function(){c(this,d,e)}),a(e)}var e={};a.registerDropDownMenuSkin=function(a,b){e[a]=b};var f={showOnHover:!0,linksWithSubmenusEnabled:!1,selected:null,beforeShowPanel:null,beforeHidePanel:null,showPanelComplete:null,hidePanelComplete:null,animationShow:null,animationHide:null,position:null,skin:"basic"};a.fn.dropDownMenu=function(c){function h(c){function e(b){m=+new Date,a.each(k.children,function(){this.hideForce(b)})}function f(a){if(m){var b=+new Date-m;if(m=!1,200>b)return}e(a)}function h(a){for(var b=0;b<g.length;b++)g[b]!==e&&g[b](a)}c.addClass("menu-item-top");var i=[],k={parent:null,children:[]},l=!1,m=!1,n=function(c,f){function g(){w.$item.addClass("menu-item-with-submenu"),w.$item.on({press:v,click:u}),j.showOnHover&&w.$item.hoverDelay(q,r,{delayOver:w.isTopLevel&&!j.showOnHover?0:200,delayOut:500}),w.isTopLevel&&w.$item.on("pointerout",function(b){if(!w.isOpen){if(b.relatedTarget&&a(this).has(b.relatedTarget).length>0&&!a(this).is(b.relatedTarget))return;o(!1)}}),w.$panel&&(w.$panel.click(function(b){var c=a(b.target).closest(".menu-item",w.$panel);if(c&&!c.hasClass("menu-item-with-submenu")){var d=n(b);if(d.$selectedItem=c,d.selectedItem=c[0],j.selected&&j.selected.call(this,d),d.cancel)return void b.stopPropagation();if(!b.isDefaultPrevented())return;e(b)}b.stopPropagation()}),j.linksWithSubmenusEnabled||i().on("click",function(a){a.preventDefault(),a.stopPropagation()}))}function i(){return d(w.$item,function(b,c){return a(b).hasClass("menu-panel")?!1:("A"==b.tagName&&c.push(b),!0)})}function n(a){return{$panel:w.$panel,panel:w,$parentPanel:w.$parentPanel,parentPanel:w.$parentPanel[0],$item:w.$item,item:w.$item[0],level:w.getLevel(),innerEvent:a,preventDefault:function(){this.cancel=!0}}}function o(a){b(w.$item,a)}function p(){return w.isTopLevel?l||j.showOnHover:!0}function q(a){w.isTopLevel&&o(!0),p()&&w.show(a)}function r(a){(!w.isTopLevel||j.showOnHover)&&p()&&w.hide(a)}function s(a){w.isOpen=!0,w.transitioning=!1,j.showPanelComplete&&j.showPanelComplete.call(w,n(a))}function t(a){w.isOpen=!1,w.transitioning=!1,j.hidePanelComplete&&j.hidePanelComplete.call(w,n(a))}function u(a){if(a.stopPropagation(),z){var b=+new Date-z;z=!1,1e3>b&&a.preventDefault()}}function v(b){if(b.stopPropagation(),w.$panel&&"mouse"!=b.pointerType){if(w.$panel.length>0){var c=a(b.target).closest(".menu-panel");if(c.length>0&&c[0]===w.$panel[0])return void(z=!1)}z=+new Date,b.preventDefault(),w.transitioning||(w[w.isOpen?"hideClick":"showClick"](b),w.isTopLevel&&(m=+new Date))}}var w=this;this.$panel=c,this.$item=f||c.closest(".menu-item"),this.$parentPanel=this.$item.closest(".menu-panel"),this.isTopLevel=0===this.$parentPanel.length,this.parent=null,this.children=[],this.isOpen=!1,this.transitioning=!1,this.$panel&&this.$panel.data("PanelInstance",this),this.resolveParent=function(){w.parent=w.$parentPanel.data("PanelInstance")||k,w.parent.children.push(w)};var x=null;this.getLevel=function(){if(null===x){x=-1;for(var a=w.parent;a;)a=a.parent,x++}return x};var y;this.getSiblings=function(){return y||(y=[],w.parent&&a.each(w.parent.children,function(){this!==w&&y.push(this)})),y},this.show=function(b){if(!w.transitioning&&!w.isOpen){var d;w.$panel&&(d=n(b),j.beforeShowPanel&&j.beforeShowPanel.call(w,d),d.cancel)||(a.each(w.getSiblings(),function(){this.hide(b)}),h(b),o(!0),w.$panel&&(w.transitioning=!0,d=n(b),j.position&&j.position(d),j.animationShow?j.animationShow.call(w,d,s):(c.show(),s())))}},this.hide=function(b){if(w.isOpen&&!w.transitioning){if(w.$panel){var d=n(b);if(j.beforeHidePanel&&j.beforeHidePanel.call(w,d),d.cancel)return}o(!1),w.$panel&&(w.transitioning=!0,a.each(w.children,function(){this.hide(b)}),j.animationHide?j.animationHide.call(w,n(b),t):(c.hide(),t()))}};var z=!1;this.showClick=function(a){w.isTopLevel&&(l=!0),w.show(a)},this.hideClick=function(a){w.isTopLevel&&(l=!1),w.hide(a)},this.hideForce=function(a){l=!1,w.hide(a)},g.apply(this)};g.push(e),c.find(".menu-panel").each(function(){i.push(new n(a(this)))}),c.not(".menu-item-with-submenu").each(function(){i.push(new n(null,a(this)))}),a.each(i,function(){this.resolveParent()}),c.find(".menu-item").hoverDelay(function(){b(a(this),!0)},function(){b(a(this),!1)}).each(function(){b(a(this),!1)}),a(document).on("click",f)}if(0===this.length)return this;var i=e[c.skin];if(!i)throw new Error("Invalid dropDownMenu skin: "+c.skin);var j=a.extend({},f,i||{},c);return j.showOnHover||(j.linksWithSubmenusEnabled=!1),this.each(function(){var b=d(a(this),function(b,c){return a(b).hasClass("menu-item")?(c.push(b),!1):!0});h(b)}),this};var g=[]}(jQuery);
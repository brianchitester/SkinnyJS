<!DOCTYPE html>

<html>
<head>
  <title>jquery.richTooltip.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="breakpoints.html">
                breakpoints.js
              </a>
            
              
              <a class="source" href="date-parse.html">
                date-parse.js
              </a>
            
              
              <a class="source" href="jquery.breakpoints.html">
                jquery.breakpoints.js
              </a>
            
              
              <a class="source" href="jquery.calcRestrainedPos.html">
                jquery.calcRestrainedPos.js
              </a>
            
              
              <a class="source" href="jquery.clientRect.html">
                jquery.clientRect.js
              </a>
            
              
              <a class="source" href="jquery.contentSize.html">
                jquery.contentSize.js
              </a>
            
              
              <a class="source" href="jquery.cookies.html">
                jquery.cookies.js
              </a>
            
              
              <a class="source" href="jquery.css.html">
                jquery.css.js
              </a>
            
              
              <a class="source" href="jquery.customEvent.html">
                jquery.customEvent.js
              </a>
            
              
              <a class="source" href="jquery.delimitedString.html">
                jquery.delimitedString.js
              </a>
            
              
              <a class="source" href="jquery.disableEvent.html">
                jquery.disableEvent.js
              </a>
            
              
              <a class="source" href="jquery.hostIframe.html">
                jquery.hostIframe.js
              </a>
            
              
              <a class="source" href="jquery.hoverDelay.html">
                jquery.hoverDelay.js
              </a>
            
              
              <a class="source" href="jquery.htmlEncode.html">
                jquery.htmlEncode.js
              </a>
            
              
              <a class="source" href="jquery.imageSize.html">
                jquery.imageSize.js
              </a>
            
              
              <a class="source" href="jquery.isVisibleKeyCode.html">
                jquery.isVisibleKeyCode.js
              </a>
            
              
              <a class="source" href="jquery.menu.html">
                jquery.menu.js
              </a>
            
              
              <a class="source" href="jquery-menu-exampleskin.html">
                jquery-menu-exampleskin.js
              </a>
            
              
              <a class="source" href="jquery.modalDialog.deviceFixes.html">
                jquery.modalDialog.deviceFixes.js
              </a>
            
              
              <a class="source" href="jquery.modalDialog.getSettings.html">
                jquery.modalDialog.getSettings.js
              </a>
            
              
              <a class="source" href="jquery.modalDialog.header.html">
                jquery.modalDialog.header.js
              </a>
            
              
              <a class="source" href="jquery.modalDialog.history.html">
                jquery.modalDialog.history.js
              </a>
            
              
              <a class="source" href="jquery.modalDialog.html">
                jquery.modalDialog.js
              </a>
            
              
              <a class="source" href="jquery.modalDialog.unobtrusive.html">
                jquery.modalDialog.unobtrusive.js
              </a>
            
              
              <a class="source" href="jquery.modalDialog.userAgent.html">
                jquery.modalDialog.userAgent.js
              </a>
            
              
              <a class="source" href="jquery.modalDialogContent.header.html">
                jquery.modalDialogContent.header.js
              </a>
            
              
              <a class="source" href="jquery.modalDialogContent.html">
                jquery.modalDialogContent.js
              </a>
            
              
              <a class="source" href="jquery.msAjax.html">
                jquery.msAjax.js
              </a>
            
              
              <a class="source" href="jquery.noPageScroll.html">
                jquery.noPageScroll.js
              </a>
            
              
              <a class="source" href="jquery.ns.html">
                jquery.ns.js
              </a>
            
              
              <a class="source" href="jquery.partialLoad.html">
                jquery.partialLoad.js
              </a>
            
              
              <a class="source" href="jquery.postMessage.html">
                jquery.postMessage.js
              </a>
            
              
              <a class="source" href="jquery.proxyAll.html">
                jquery.proxyAll.js
              </a>
            
              
              <a class="source" href="jquery.queryString.html">
                jquery.queryString.js
              </a>
            
              
              <a class="source" href="jquery.richTooltip.html">
                jquery.richTooltip.js
              </a>
            
              
              <a class="source" href="jquery.scrollAnchor.html">
                jquery.scrollAnchor.js
              </a>
            
              
              <a class="source" href="jquery.uncomment.html">
                jquery.uncomment.js
              </a>
            
              
              <a class="source" href="jquery.url.html">
                jquery.url.js
              </a>
            
              
              <a class="source" href="pointy.gestures.html">
                pointy.gestures.js
              </a>
            
              
              <a class="source" href="pointy.html">
                pointy.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>jquery.richTooltip.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p>/ <reference path="jquery.clientRect.js" />
/ <reference path="jquery.proxyAll.js" />
/ <reference path="jquery.calcRestrainedPos.js" />
/ <reference path="jquery.hoverDelay.js" /></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($)</span> </span>{
    <span class="hljs-keyword">var</span> arrowDirections = {
        south: <span class="hljs-string">'north'</span>,
        north: <span class="hljs-string">'south'</span>,
        east: <span class="hljs-string">'west'</span>,
        west: <span class="hljs-string">'east'</span>
    };

    <span class="hljs-keyword">var</span> defaults = {
        pos: <span class="hljs-string">'south'</span>,
        arrowDirection: <span class="hljs-literal">null</span>,
        arrowStyle: <span class="hljs-string">'outset'</span>
    };

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Tooltip</span><span class="hljs-params">(context, options)</span> </span>{
        $.proxyAll(<span class="hljs-keyword">this</span>, <span class="hljs-string">'show'</span>, <span class="hljs-string">'hide'</span>, <span class="hljs-string">'toggle'</span>, <span class="hljs-string">'pos'</span>, <span class="hljs-string">'unhover'</span>, <span class="hljs-string">'onWindowResize'</span>, <span class="hljs-string">'onDocumentClick'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>target context element that initalizes this tooltip</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.context = $(context);</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>store options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.options = $.extend({}, defaults, options || {});</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>determine the content of the tooltip</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.content = $(<span class="hljs-keyword">this</span>.options.content).eq(<span class="hljs-number">0</span>).addClass(<span class="hljs-string">'rich-tooltip-content'</span>); <span class="hljs-comment">// class adds legacy browser support</span></pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>ensure we actually found the content</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.content.length === <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'jquery.richTooltip: failed to find desired tooltip'</span>);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>add functional classes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.content.addClass(<span class="hljs-string">'rich-tooltip-pos-'</span> + <span class="hljs-keyword">this</span>.options.pos);</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>move the content to the body to avoid positioning conflicts</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.content.appendTo(<span class="hljs-string">'body'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>configure the context</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.context.attr(<span class="hljs-string">'data-rel'</span>, <span class="hljs-string">'tooltip'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>setup the hover events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.action === <span class="hljs-string">'hover'</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>soft dependency on hoverDelay</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> ($.fn.hoverDelay) {</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>hover is desktop only, and does not support pointer events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>.context.hoverDelay(<span class="hljs-keyword">this</span>.show, <span class="hljs-keyword">this</span>.unhover, { delayOver: <span class="hljs-number">200</span>, delayOut: <span class="hljs-number">500</span>, addChildren: <span class="hljs-keyword">this</span>.content });</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>hover over the tooltip content should not hide the tooltip yet</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>.content.hoverDelay(<span class="hljs-keyword">this</span>.show, <span class="hljs-keyword">this</span>.unhover, { delayOver: <span class="hljs-number">200</span>, delayOut: <span class="hljs-number">500</span>, addChildren: <span class="hljs-keyword">this</span>.context });
            } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>hover is desktop only, and does not support pointer events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>.context.hover(<span class="hljs-keyword">this</span>.show, <span class="hljs-keyword">this</span>.unhover);</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>hover over the tooltip content should not hide the tooltip yet</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>.content.hover(<span class="hljs-keyword">this</span>.show, <span class="hljs-keyword">this</span>.unhover);
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>timestamp of last touch event, used to determine if we should preventDefault on the next click event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> ignoreNextClick = <span class="hljs-literal">null</span>;

            <span class="hljs-keyword">var</span> checkEvent = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(event)</span> </span>{
                event.preventDefault();</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>if this is a touch type event, then record it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">if</span> (event.pointerType === <span class="hljs-string">'touch'</span>) {
                    ignoreNextClick = +(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>());
                }
            };</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>listen to pointer down and record the event to be used on click
calling prevent default on pointerup/pointerdown does not
prevent navigation, preventDefault must happen within click event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.context.on({
                <span class="hljs-string">'pointerdown'</span>: checkEvent,
                <span class="hljs-string">'pointerup'</span>: checkEvent
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>listen to clicks, and call prevent default on touch devices</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.context.on(<span class="hljs-string">'click'</span>, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(event)</span> </span>{
                <span class="hljs-keyword">if</span> (ignoreNextClick !== <span class="hljs-literal">null</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>calculate time delta between last touch event and now</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    <span class="hljs-keyword">var</span> timeDiff = +(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()) - ignoreNextClick;</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>if time delta is less than 300ms, assume this is a touch tap
and toggle visibility of tooltip rather than allow navigation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    <span class="hljs-keyword">if</span> (timeDiff &lt; <span class="hljs-number">300</span>) {
                        <span class="hljs-keyword">this</span>.toggle(event);
                    }
                }
            }, <span class="hljs-keyword">this</span>));
        } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>when hover is off, we simply toggle on click event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.context.on(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">this</span>.toggle);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>find the container element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.container = <span class="hljs-keyword">this</span>.options.container ? $(<span class="hljs-keyword">this</span>.options.container) : <span class="hljs-literal">null</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>look for exiting arrow</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.arrow = <span class="hljs-keyword">this</span>.content.find(<span class="hljs-string">'.rich-tooltip-arrow'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>no arrow found, create one</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.arrow.length === <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">this</span>.arrow = $(<span class="hljs-string">'&lt;div class="rich-tooltip-arrow" /&gt;'</span>).appendTo(<span class="hljs-keyword">this</span>.content);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>standardize to have an arrow direction</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.options.arrowDirection) {
            <span class="hljs-keyword">this</span>.options.arrowDirection = arrowDirections[<span class="hljs-keyword">this</span>.options.pos];
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>anything with [data-rel=”close”] can be used to close the tooltip</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.content.on(<span class="hljs-string">'click'</span>, <span class="hljs-string">'[data-rel="close"]'</span>, <span class="hljs-keyword">this</span>.hide);
    }

    Tooltip.prototype.unhover = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">this</span>._clearHoverTimeout();
        <span class="hljs-keyword">this</span>.hoverTimeout = setTimeout(<span class="hljs-keyword">this</span>.hide, <span class="hljs-number">250</span>);
    };

    Tooltip.prototype._clearHoverTimeout = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.hoverTimeout) {
            clearTimeout(<span class="hljs-keyword">this</span>.hoverTimeout);
            <span class="hljs-keyword">this</span>.hoverTimeout = <span class="hljs-literal">null</span>;
        }
    };

    Tooltip.prototype.show = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">this</span>._clearHoverTimeout();</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>ensure all other tooltips and other overlay controls are closed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-built_in">document</span>).trigger(<span class="hljs-string">'closeEverything'</span>);

        <span class="hljs-keyword">this</span>.content.show();
        <span class="hljs-keyword">this</span>.pos();
        <span class="hljs-keyword">this</span>.context.addClass(<span class="hljs-string">'rich-tooltip-open'</span>); <span class="hljs-comment">// indicate to the context the tooltip is open</span>

        <span class="hljs-keyword">this</span>.viewportSize = {
            height: $(<span class="hljs-built_in">window</span>).height(),
            width: $(<span class="hljs-built_in">window</span>).width()
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>hide the tooltip if the browser resizes, the user can open it back up easily</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-built_in">window</span>).on(<span class="hljs-string">'resize'</span>, <span class="hljs-keyword">this</span>.onWindowResize);
        $(<span class="hljs-built_in">window</span>).one(<span class="hljs-string">'scroll'</span>, <span class="hljs-keyword">this</span>.hide);</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>hide the tooltip if user clicks outside of the tooltip</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-built_in">document</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">this</span>.onDocumentClick);
        $(<span class="hljs-built_in">document</span>).one(<span class="hljs-string">'closeEverything'</span>, <span class="hljs-keyword">this</span>.hide);

        <span class="hljs-keyword">this</span>.visible = <span class="hljs-literal">true</span>;
    };

    Tooltip.prototype.hide = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">this</span>._clearHoverTimeout();
        <span class="hljs-keyword">this</span>.content.hide();
        <span class="hljs-keyword">this</span>.context.removeClass(<span class="hljs-string">'rich-tooltip-open'</span>); <span class="hljs-comment">// indicate to the context the tooltip is now closed</span></pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>remove event listeners</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-built_in">window</span>).off(<span class="hljs-string">'resize'</span>, <span class="hljs-keyword">this</span>.onWindowResize);
        $(<span class="hljs-built_in">window</span>).off(<span class="hljs-string">'scroll'</span>, <span class="hljs-keyword">this</span>.hide);
        $(<span class="hljs-built_in">document</span>).off(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">this</span>.onDocumentClick);
        $(<span class="hljs-built_in">document</span>).off(<span class="hljs-string">'closeEverything'</span>, <span class="hljs-keyword">this</span>.hide);

        <span class="hljs-keyword">this</span>.visible = <span class="hljs-literal">false</span>;
    };

    Tooltip.prototype.toggle = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(event)</span> </span>{
        <span class="hljs-keyword">if</span> (event) {
            event.preventDefault();
            event.stopPropagation();
        }

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.visible) {
            <span class="hljs-keyword">this</span>.hide();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">this</span>.show();
        }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>on window resize, confirm the window actually changed sizes
IE9 and below triggers a resize on any element changing size,
this includes elements becoming visible or hidding
@see <a href="http://stackoverflow.com/questions/1852751/window-resize-event-firing-in-internet-explorer">http://stackoverflow.com/questions/1852751/window-resize-event-firing-in-internet-explorer</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Tooltip.prototype.onWindowResize = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> ($(<span class="hljs-built_in">window</span>).height() != <span class="hljs-keyword">this</span>.viewportSize.height || $(<span class="hljs-built_in">window</span>).width() != <span class="hljs-keyword">this</span>.viewportSize.width) {
            <span class="hljs-keyword">this</span>.hide();
        }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>on a document click event, we close the tooltip is the click
was not to the tooltip or a child of the tooltip</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Tooltip.prototype.onDocumentClick = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> </span>{
        <span class="hljs-keyword">var</span> target = $(e.target);
        <span class="hljs-keyword">if</span> (!target.is(<span class="hljs-keyword">this</span>.content) &amp;&amp; !target.isChildOf(<span class="hljs-keyword">this</span>.content)) {
            <span class="hljs-keyword">this</span>.hide();
        }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>padding constant used during position calculations</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> PADDING = <span class="hljs-number">10</span>;

    Tooltip.prototype.pos = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>find the size of the arrow</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> arrowRect = (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(self)</span> </span>{
            <span class="hljs-keyword">if</span> (self.arrow.css(<span class="hljs-string">'display'</span>) == <span class="hljs-string">'none'</span> || self.options.arrowStyle === <span class="hljs-string">'inset'</span>) {
                <span class="hljs-keyword">return</span> { width: <span class="hljs-number">0</span>, height: <span class="hljs-number">0</span> };
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>override, css arrows do not return sized because it uses :before and :after</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (self.options.arrowDirection === <span class="hljs-string">'east'</span> || self.options.arrowDirection === <span class="hljs-string">'west'</span>) {
                <span class="hljs-keyword">return</span> { width: <span class="hljs-number">15</span>, height: <span class="hljs-number">25</span> };
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> { width: <span class="hljs-number">25</span>, height: <span class="hljs-number">15</span> };
            }
        })(<span class="hljs-keyword">this</span>);

        <span class="hljs-keyword">var</span> restrainedPos = $.calcRestrainedPos({
            giveMeSomething: <span class="hljs-literal">true</span>,
            direction: <span class="hljs-keyword">this</span>.options.pos,
            content: <span class="hljs-keyword">this</span>.content.css(<span class="hljs-string">'max-width'</span>, <span class="hljs-string">'100%'</span>),
            context: <span class="hljs-keyword">this</span>.context,
            container: <span class="hljs-keyword">this</span>.container,
            reset: {
                margin: <span class="hljs-number">0</span>
            },
            offsets: {
                viewport: PADDING,
                vertical: arrowRect.height,
                horizontal: arrowRect.width
            }
        });

        <span class="hljs-keyword">var</span> pos = restrainedPos.pos;
        <span class="hljs-keyword">var</span> contextRect = <span class="hljs-keyword">this</span>.context.clientRect();
        <span class="hljs-keyword">var</span> arrowPos = {};

        <span class="hljs-keyword">if</span> (restrainedPos.direction !== <span class="hljs-keyword">this</span>.options.pos) {
            <span class="hljs-keyword">this</span>.content
                .removeClass(<span class="hljs-string">'rich-tooltip-pos-'</span> + <span class="hljs-keyword">this</span>.options.pos)
                .addClass(<span class="hljs-string">'rich-tooltip-pos-'</span> + restrainedPos.direction);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>determine the new arrow direction</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> arrowDirection = <span class="hljs-keyword">this</span>.options.arrowDirection || arrowDirections[restrainedPos.direction];</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>remove any previously added tooltip arrow direction class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $.each(arrowDirections, $.proxy(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(tooltipPosition, arrowDir)</span> </span>{
            <span class="hljs-keyword">this</span>.arrow.removeClass(<span class="hljs-string">'tooltip-arrow-'</span> + arrowDir);
        }, <span class="hljs-keyword">this</span>));</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>position the arrow for top and bottom</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">switch</span> (restrainedPos.direction) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'north'</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">'south'</span>:
            arrowPos.left = contextRect.left - pos.left + (contextRect.width / <span class="hljs-number">2</span>);
            arrowPos[restrainedPos.direction === <span class="hljs-string">'north'</span> ? <span class="hljs-string">'bottom'</span> : <span class="hljs-string">'top'</span>] = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> <span class="hljs-string">'east'</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">'west'</span>:
            arrowPos.top = contextRect.top - pos.top + (contextRect.height / <span class="hljs-number">2</span>);
            arrowPos[restrainedPos.direction === <span class="hljs-string">'east'</span> ? <span class="hljs-string">'left'</span> : <span class="hljs-string">'right'</span>] = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">break</span>;
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>if we are changing the default behavior we have to adjust slightly</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.arrowStyle === <span class="hljs-string">'inset'</span>) {
            <span class="hljs-keyword">switch</span> (arrowDirection) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'north'</span>:
                arrowPos.top += <span class="hljs-number">1</span>;
                <span class="hljs-keyword">break</span>;

            <span class="hljs-keyword">case</span> <span class="hljs-string">'east'</span>:
                arrowPos.left -= <span class="hljs-number">1</span>;
                <span class="hljs-keyword">break</span>;

            <span class="hljs-keyword">case</span> <span class="hljs-string">'south'</span>:
                arrowPos.top -= <span class="hljs-number">1</span>;
                <span class="hljs-keyword">break</span>;

            <span class="hljs-keyword">case</span> <span class="hljs-string">'west'</span>:
                arrowPos.left += <span class="hljs-number">1</span>;
                <span class="hljs-keyword">break</span>;
            }
        }

        <span class="hljs-keyword">this</span>.content.css(pos);

        <span class="hljs-keyword">this</span>.arrow</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>add the tooltip arrow direction class</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            .addClass(<span class="hljs-string">'tooltip-arrow-'</span> + arrowDirection)</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>assign the new arrow styling</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            .css(arrowPos);
    };

    $.fn.tooltip = $.fn.richTooltip = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jQueryTooltip</span><span class="hljs-params">(options)</span> </span>{
        <span class="hljs-keyword">var</span> el = $(<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">var</span> tooltip = el.data(<span class="hljs-string">'__tooltip'</span>);

        <span class="hljs-keyword">if</span> (!tooltip) {
            tooltip = <span class="hljs-keyword">new</span> Tooltip(el, options);
            el.data(<span class="hljs-string">'__tooltip'</span>, tooltip);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>allow this to be used to run methods on the tooltips</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> options === <span class="hljs-string">'string'</span> &amp;&amp; options <span class="hljs-keyword">in</span> tooltip) {
            tooltip[options]();
        }
    };

    $.fn.isChildOf = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jQueryIsChildOf</span><span class="hljs-params">(filter_string)</span> </span>{
        <span class="hljs-keyword">var</span> parents = $(<span class="hljs-keyword">this</span>).parents();

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; parents.length; j++) {
            <span class="hljs-keyword">if</span> ($(parents[j]).is(filter_string)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
        }

        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>initialize all existing tooltips</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    $(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        $(<span class="hljs-string">'[data-rel="tooltip"] + aside'</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i, el)</span> </span>{
            <span class="hljs-keyword">var</span> content = $(el);
            <span class="hljs-keyword">var</span> context = content.prev().addClass(<span class="hljs-string">'rich-tooltip-context'</span>);
            <span class="hljs-keyword">var</span> data = context.data();</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>translate data attributes to options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            context.richTooltip({
                content: content,
                action: data.tooltipAction || <span class="hljs-string">'click'</span>,
                pos: data.tooltipPos || <span class="hljs-string">'south'</span>,
                container: data.tooltipContainer || <span class="hljs-literal">undefined</span>,
                arrowDirection: data.tooltipArrowDirection || <span class="hljs-literal">null</span>,
                arrowStyle: data.tooltipArrowStyle || <span class="hljs-literal">null</span>
            });
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>allow instances without the <aside> directly after the context</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-string">'[data-tooltip]'</span>).each(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(i, el)</span> </span>{
            <span class="hljs-keyword">var</span> context = $(el);
            <span class="hljs-keyword">var</span> data = context.data();
            <span class="hljs-keyword">var</span> content = $(data.tooltip);</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>translate data attributes to options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            context.richTooltip({
                content: content,
                action: data.tooltipAction || <span class="hljs-string">'click'</span>,
                pos: data.tooltipPos || <span class="hljs-string">'south'</span>,
                container: data.tooltipContainer || <span class="hljs-literal">undefined</span>,
                arrowDirection: data.tooltipArrowDirection || <span class="hljs-literal">null</span>,
                arrowStyle: data.tooltipArrowStyle || <span class="hljs-literal">null</span>
            });
        });
    });
})(jQuery);</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
